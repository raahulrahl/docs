---
title: 'Jaeger Setup'
description: 'Set up Jaeger for distributed tracing visualization'
---

# Jaeger Setup

Jaeger is an open-source distributed tracing platform that helps you monitor and troubleshoot your Bindu agents.

## Quick Start

<Steps>
  <Step title="Start Jaeger">
    ```bash
    docker run -d --name jaeger \
      -e COLLECTOR_OTLP_ENABLED=true \
      -p 16686:16686 \
      -p 4317:4317 \
      -p 4318:4318 \
      jaegertracing/all-in-one:latest
    ```
    
    **Ports:**
    - `16686` - Jaeger UI (web interface)
    - `4317` - OTLP gRPC receiver
    - `4318` - OTLP HTTP receiver
  </Step>

  <Step title="Configure Bindu">
    Add to your agent config:
    
    ```json
    {
      "name": "my-agent",
      "telemetry": true,
      "oltp": {
        "endpoint": "http://localhost:4318/v1/traces",
        "service_name": "bindu-agent"
      }
    }
    ```
    
    Or use environment variables:
    ```bash
    export OTEL_EXPORTER_OTLP_ENDPOINT="http://localhost:4318/v1/traces"
    export OTEL_SERVICE_NAME="bindu-agent"
    ```
  </Step>

  <Step title="Run Your Agent">
    ```bash
    python your_agent.py
    ```
  </Step>

  <Step title="View Traces">
    Open http://localhost:16686 in your browser
  </Step>
</Steps>

---

## Jaeger UI Overview

### Service View

The main dashboard shows:

- **Service Name** - Your agent service (`bindu-agent`)
- **Operations** - All traced operations:
  - `task_manager.send_message`
  - `task_manager.get_task`
  - `task_manager.cancel_task`
  - `run task`
  - `agent.execute`

### Trace View

Complete request flow with timing:

```
task_manager.send_message (250ms)
└─ run task (220ms)
   └─ agent.execute (200ms)
```

**Visual Features:**
- Color-coded by service
- Shows parallel vs sequential execution
- Hover for span details
- Click to expand/collapse

### Span Details

Each span shows:

**Attributes (Tags):**
- `bindu.operation` - Operation name
- `bindu.request_id` - Request identifier
- `bindu.task_id` - Task UUID
- `bindu.context_id` - Context UUID
- `bindu.agent.name` - Agent name
- `bindu.agent.did` - Agent DID
- `bindu.agent.execution_time` - Execution duration
- `bindu.component` - Component type

**Events (Logs):**
- `task.state_changed` - State transitions
  - `from_state` - Previous state
  - `to_state` - New state
  - `error` - Error message (if failed)

---

## Search & Filter

### By Service

```
Service: bindu-agent
```

### By Operation

```
Operation: task_manager.send_message
```

### By Tags

```
bindu.task_id = "550e8400-e29b-41d4-a716-446655440000"
bindu.agent.name = "my-agent"
error = true
```

### By Duration

```
Min Duration: 100ms
Max Duration: 5s
```

### By Time Range

- Last 1 hour
- Last 24 hours
- Custom range

---

## Jaeger UI Features

### 1. Trace Timeline

- Visual span hierarchy
- Color-coded by service
- Parallel vs sequential execution
- Interactive hover details

### 2. Trace Comparison

- Compare multiple traces side-by-side
- Identify performance regressions
- Spot anomalies

### 3. Service Dependencies

- Visualize service interactions
- Identify bottlenecks
- Understand system architecture

### 4. Statistics

- Latency percentiles (p50, p95, p99)
- Error rates
- Request volume
- Operation distribution

---

## Production Deployment

### Docker Compose

```yaml
version: '3'
services:
  jaeger:
    image: jaegertracing/all-in-one:latest
    environment:
      - COLLECTOR_OTLP_ENABLED=true
      - SPAN_STORAGE_TYPE=elasticsearch
      - ES_SERVER_URLS=http://elasticsearch:9200
    ports:
      - "16686:16686"
      - "4317:4317"
      - "4318:4318"
    depends_on:
      - elasticsearch

  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:7.17.0
    environment:
      - discovery.type=single-node
    ports:
      - "9200:9200"
```

### Kubernetes

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jaeger
spec:
  replicas: 1
  selector:
    matchLabels:
      app: jaeger
  template:
    metadata:
      labels:
        app: jaeger
    spec:
      containers:
      - name: jaeger
        image: jaegertracing/all-in-one:latest
        env:
        - name: COLLECTOR_OTLP_ENABLED
          value: "true"
        ports:
        - containerPort: 16686
        - containerPort: 4317
        - containerPort: 4318
---
apiVersion: v1
kind: Service
metadata:
  name: jaeger
spec:
  selector:
    app: jaeger
  ports:
  - name: ui
    port: 16686
  - name: otlp-grpc
    port: 4317
  - name: otlp-http
    port: 4318
```

---

## Performance Tuning

### Batch Processor Configuration

```bash
# High-volume production
export OTEL_BSP_MAX_QUEUE_SIZE="4096"
export OTEL_BSP_SCHEDULE_DELAY="10000"
export OTEL_BSP_MAX_EXPORT_BATCH_SIZE="1024"
export OTEL_BSP_EXPORT_TIMEOUT="60000"
```

### Sampling

```bash
# Sample 10% of traces
export OTEL_TRACES_SAMPLER="parentbased_traceidratio"
export OTEL_TRACES_SAMPLER_ARG="0.1"
```

---

## Troubleshooting

<AccordionGroup>
  <Accordion title="Traces Not Appearing">
    **Check:**
    
    1. Jaeger is running:
    ```bash
    docker ps | grep jaeger
    curl http://localhost:16686
    ```
    
    2. OTLP endpoint is reachable:
    ```bash
    curl -X POST http://localhost:4318/v1/traces \
      -H "Content-Type: application/json" \
      -d '{"resourceSpans":[]}'
    ```
    
    3. Agent logs show observability initialization:
    ```
    [INFO] Initializing observability...
    [INFO] Configured OTLP exporter endpoint=http://localhost:4318/v1/traces
    ```
  </Accordion>

  <Accordion title="Slow Performance">
    **Cause:** Too many spans or large payloads
    
    **Solution:**
    - Enable batch processing
    - Increase batch delay
    - Implement sampling
    ```bash
    export OTEL_USE_BATCH_PROCESSOR="true"
    export OTEL_BSP_SCHEDULE_DELAY="10000"
    export OTEL_TRACES_SAMPLER="parentbased_traceidratio"
    export OTEL_TRACES_SAMPLER_ARG="0.1"
    ```
  </Accordion>

  <Accordion title="Missing Spans">
    **Cause:** Span context not propagated
    
    **Solution:** Verify span propagation in scheduler:
    ```python
    task_operation["_current_span"] = get_current_span()
    ```
  </Accordion>
</AccordionGroup>

---

## Alternative Backends

Bindu works with any OpenTelemetry-compatible backend:

### Grafana Tempo

```bash
export OTEL_EXPORTER_OTLP_ENDPOINT="http://tempo:4318/v1/traces"
```

### Zipkin

```bash
export OTEL_EXPORTER_ZIPKIN_ENDPOINT="http://zipkin:9411/api/v2/spans"
```

### SigNoz

```bash
export OTEL_EXPORTER_OTLP_ENDPOINT="http://signoz:4318/v1/traces"
```

### Honeycomb

```bash
export OTEL_EXPORTER_OTLP_ENDPOINT="https://api.honeycomb.io"
export OTEL_EXPORTER_OTLP_HEADERS="x-honeycomb-team=YOUR_API_KEY"
```

---

## Next Steps

<CardGroup cols={2}>
  <Card title="Tracing Guide" icon="route" href="/bindu/learn/observability/tracing">
    Learn about distributed tracing
  </Card>
  <Card title="Metrics" icon="chart-bar" href="/bindu/learn/observability/metrics">
    Track performance metrics
  </Card>
  <Card title="Overview" icon="eye" href="/bindu/learn/observability/overview">
    Back to observability overview
  </Card>
  <Card title="Jaeger Docs" icon="book" href="https://www.jaegertracing.io/docs/">
    Official Jaeger documentation
  </Card>
</CardGroup>

---

## Resources

- **[Jaeger Documentation](https://www.jaegertracing.io/docs/)** - Official Jaeger docs
- **[Jaeger UI Guide](https://www.jaegertracing.io/docs/latest/frontend-ui/)** - UI features and usage
- **[Deployment Guide](https://www.jaegertracing.io/docs/latest/deployment/)** - Production deployment
- **[GitHub](https://github.com/jaegertracing/jaeger)** - Jaeger source code
